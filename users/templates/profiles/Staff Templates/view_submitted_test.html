{% extends 'profiles/Staff Templates/base.html'%}
{% load static %}
{% block css %}
    <link rel="stylesheet" href="{% static 'profile/admin/add-staff.css' %}">
    <link rel="stylesheet" href="{% static 'profile/admin/add-students.css' %}">
    <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.css' %}">
    <style>
        #mg-subtest{
            background-color: white;
            color: rgb(8, 0, 98);
        }
    </style>
{% endblock css %}
{% block  content%}
    <h3 class="add-staff">Submitted Tests</h3>

    {% for message in messages %}
        {% if message.tags == "success" %}
            <div class="message" id="success-msg">{{message}}</div>
        {% elif message.tags == "error" %}
            <div class="message" id="error-msg">{{message}}</div> 
        {% else %}
            <div class="message" id="other-msg">{{message}}</div>
        {% endif%} 
    {% endfor %}

    {% for assign in submit %}
        {% if assign.score %}
        {% else %}
            <div class="container" style="margin-top: 45px; background-color: beige;">
            {% if assign.assignment.submitted_by.student_class == request.user.staff.form_class %}
            {% if assign.test.created_by.id == request.user.staff.id %}
                <form action="" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="id" value="{{ assign.id }}" id="">
                    <p>Test Subject: <h2>{{ assign.subject.name }}</h2></p>
                    <input type="hidden" name="subject" value="{{ assign.subject.id }}" id="">
                    <input type="hidden" name="id" value="{{ assign.id }}" id="">
                    <input type="hidden" class="form-control" name="submitted_assignment_text" value="{{ assign.submitted_test_text }}">


                    <p>Test Submitted By: <h2>{{ assign.submitted_by.admin.username }} {{ assign.submitted_by.admin.first_name }} {{ assign.submitted_by.admin.last_name}}</h2></p>
                    <p>Date Submitted: <h2>{{ assign.created_at }} </h2></p>
                    <input type="hidden" name="submitted_by" value="{{ assign.submitted_by.id }}" id="">

                    {% if assign.submitted_test_file %}
                        <input class="form-control" type="hidden" name="submitted_test_file" value="{{assign.submitted_test_file.url}}" id="">
                        <p>Test file:
                        <a href="{{ assign.submitted_test_file.url }}" download>
                            Download Test File
                        </a></p>
                    {% endif %}
                    <textarea disabled class="form-control" cols="50" rows="10" name="submitted_test_text">{{ assign.submitted_test_text }}</textarea>
                    <input type="number" class="form-control" name="score" placeholder="Score" id="id_email">
                    <div class="card-footer">
                        <button type="submit" class="btn btn-primary" id="submit-btn">Mark Test</button>
                    </div>
                </form>
            {% endif %}
            {% endif %}
        {% endif %}
        </div>            
    {% endfor %}
{% endblock %}
